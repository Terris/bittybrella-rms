# Migration `20200525164320-add-products-on-tickets`

This migration has been generated by Terris Kremer at 5/25/2020, 4:43:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."ProductsOnTickets" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"productId" integer  NOT NULL ,"quantity" integer  NOT NULL ,"ticketId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."User" ALTER COLUMN "role" SET DEFAULT 'USER';

ALTER TABLE "public"."ProductsOnTickets" ADD FOREIGN KEY ("productId")REFERENCES "public"."Product"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."ProductsOnTickets" ADD FOREIGN KEY ("ticketId")REFERENCES "public"."Ticket"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200523160441-add-users..20200525164320-add-products-on-tickets
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource DS {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider      = "prisma-client-js"
@@ -22,9 +22,9 @@
 model Menu {
   id          Int       @id @default(autoincrement())
   name        String
   description String
-  products    Product[]   @relation(references: [id])
+  products    Product[] @relation(references: [id])
   createdAt   DateTime  @default(now())
 }
 model Ticket {
@@ -33,8 +33,18 @@
   products    Product[]
   createdAt   DateTime  @default(now())
 }
+model ProductsOnTickets {
+  id          Int       @id @default(autoincrement())
+  product     Product   @relation(fields: [productId], references: [id])
+  productId   Int
+  ticket      Ticket    @relation(fields: [ticketId], references: [id])
+  ticketId    Int
+  quantity    Int
+  createdAt   DateTime  @default(now())
+}
+
 model User {
   id          Int       @id @default(autoincrement())
   name        String
   email       String
```


